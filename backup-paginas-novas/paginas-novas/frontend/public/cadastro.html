<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Ecossistema de Energia Solar - Plataforma Completa">
  <title>Ecossistema Energia Solar</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
  <style>
    body {
      background: #f7f9fb;
      font-family: 'Segoe UI', sans-serif;
    }
    header {
      background: #ffffff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      padding: 1rem 0;
    }
    .navbar-brand {
      font-weight: bold;
      color: #28a745;
    }
    .nav-link {
      color: #333;
      font-weight: 500;
      margin: 0 10px;
    }
    .nav-link:hover {
      color: #28a745;
    }
    /* Tabs highlight: verde claro para o ativo */
    .nav-tabs .nav-link.active {
      background: #b2f5c6 !important;
      color: #218838 !important;
      border-color: #b2e5c6 #b2e5c6 #fff !important;
      font-weight: bold;
      transition: background 0.2s;
    }
    .nav-tabs .nav-link {
      border: 1px solid #b2e5c6 !important;
      background: #f7f9fb;
      color: #218838;
      margin-right: 2px;
    }
    section {
      padding: 4rem 0;
    }
    h2 {
      font-weight: 700;
      color: #1e7e34;
    }
    .form-control, .form-select {
      border-radius: 0.375rem;
      margin-bottom: 8px;
    }
    .btn-custom {
      background: #28a745;
      color: white;
      font-weight: 600;
      border-radius: 50px;
      padding: 0.6rem 2rem;
      transition: 0.3s ease;
    }
    .btn-custom:hover {
      background: #1e7e34;
    }
    footer {
      background: #155724;
      color: #ffffff;
      padding: 2rem 0;
      text-align: center;
    }
    .uc-section {
      margin-top: 48px;
      margin-bottom: 32px;
      padding: 32px 24px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 2px 16px rgba(40,167,69,0.08);
    }
    .uc-title {
      font-size: 1.4rem;
      font-weight: 700;
      color: #218838;
      margin-bottom: 18px;
      letter-spacing: 0.5px;
      text-align: center;
    }
    .uc-group {
      background: #f8f9fa;
      border-radius: 10px;
      border: 1px solid #e0e0e0;
      padding: 18px 18px 10px 18px;
      margin-bottom: 18px;
      position: relative;
      box-shadow: 0 2px 8px rgba(40,167,69,0.04);
      transition: box-shadow 0.2s;
    }
    .uc-group:hover {
      box-shadow: 0 4px 16px rgba(40,167,69,0.10);
    }
    .uc-remove-btn {
      background: #dc3545;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      position: absolute;
      top: 16px;
      right: 16px;
      z-index: 2;
      transition: background 0.2s;
    }
    .uc-remove-btn:hover {
      background: #b52a37;
    }
    .uc-label {
      font-weight: bold;
      color: #218838;
      margin-bottom: 10px;
      font-size: 1.1rem;
      letter-spacing: 0.2px;
    }
    .uc-fields-row {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 8px;
    }
    .uc-fields-row > .form-group {
      flex: 1 1 180px;
      min-width: 160px;
    }
    .form-group label {
      font-size: 0.97rem;
      color: #155724;
      font-weight: 500;
      margin-bottom: 3px;
    }
    .uc-divider {
      border-top: 1px dashed #bdbdbd;
      margin: 18px 0 10px 0;
    }
    @media (max-width: 768px) {
      .uc-fields-row {
        flex-direction: column;
        gap: 0;
      }
      .uc-section {
        padding: 18px 5px;
      }
    }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      AOS.init();
    });
  </script>
</head>

<body>
<header class="fixed-top">
  <div class="container d-flex justify-content-between align-items-center">
    <a href="/index.html" class="navbar-brand">Ecossistema Energia</a>
    <nav>
      <ul class="nav">
        <li class="nav-item"><a class="nav-link" href="/index.html#hero">Início</a></li>
        <li class="nav-item"><a class="nav-link" href="/index.html#servicos">Soluções</a></li>
        <li class="nav-item"><a class="nav-link" href="/index.html#sobre">Sobre</a></li>
        <li class="nav-item"><a class="nav-link" href="/index.html#indicadores">Indicadores</a></li>
        <li class="nav-item"><a class="nav-link" href="/index.html#fale">Contato</a></li>
        <li class="nav-item"><a class="nav-link" href="/usinascadastro.html#usinascadastro">Cadastro</a></li>
        <li class="nav-item"><a class="nav-link" href="/visualizadoridividual.html">Perfil</a></li>
        <li class="nav-item"><a class="nav-link" href="/userdados.html">Usuários</a></li>
        <li class="nav-item"><a class="nav-link" href="/login4w.html">Login</a></li>
      </ul>
    </nav>
  </div>
</header>


  <div class="login4w-container">
    <!-- seu formulário de login aqui -->
  </div>
</body>
 
  <main style="margin-top: 80px;">
    <section id="hero" class="text-center bg-success text-white" data-aos="fade-up">
      <div class="container"> 
        <h1 class="display-5 fw-bold"> Energia | Gestão de Ativos Renováveis </h1>
        <p class="lead">Tecnologia, sustentabilidade e economia em um só lugar</p>
      </div>
    </section>

    <section id="cadastro" data-aos="fade-up">
      <div class="container mb-4">
        <ul class="nav nav-tabs justify-content-center" id="cadastroTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="pf-tab" data-bs-toggle="tab" data-bs-target="#pf" type="button" role="tab" aria-controls="pf" aria-selected="true">Pessoa Física</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="pj-tab" data-bs-toggle="tab" data-bs-target="#pj" type="button" role="tab" aria-controls="pj" aria-selected="false">Pessoa Jurídica</button>
          </li>
        </ul>
        <div class="tab-content pt-4" id="cadastroTabsContent">
          <!-- Pessoa Física -->
          <div class="tab-pane fade show active" id="pf" role="tabpanel" aria-labelledby="pf-tab">
            <form class="row g-3" id="formPF" autocomplete="off">
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Nome completo" name="nome" required>
              </div>
              <div class="col-md-3">
                <input type="text" class="form-control" placeholder="RG" name="rg">
              </div>
              <div class="col-md-3">
                <input type="text" class="form-control" placeholder="CPF" name="cpf" required>
              </div>
              <div class="col-md-4">
                <input type="date" class="form-control" placeholder="Data de nascimento" name="nascimento" required>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control" placeholder="Naturalidade" name="naturalidade" required>
              </div>
              <div class="col-md-4">    
                <div class="mb-3">
                  <label for="estadoCivil" class="form-label">Estado Civil</label>
                  <select class="form-select" id="estadoCivil" name="estado_civil" required>
                    <option value="">Selecione</option>
                    <option value="solteiro">Solteiro(a)</option>
                    <option value="casado">Casado(a)</option>
                    <option value="divorciado">Divorciado(a)</option>
                    <option value="viuvo">Viúvo(a)</option>
                    <option value="uniao_estavel">União Estável</option>
                    <option value="separado">Separado(a)</option>
                  </select>
                </div>
              </div>
              <div class="col-md-6">
                <label class="form-label">Anexar documentos de Identificação</label>
                <input type="file" class="form-control" name="doc_anexo[]" accept=".pdf,.jpg,.jpeg,.png" multiple required>
                <small class="text-muted">Máximo 10 arquivos</small>
              </div>
              <div class="col-md-6">
                <label class="form-label">Anexar conta de luz</label>
                <input type="file" class="form-control" name="conta_luz[]" accept=".pdf,.jpg,.jpeg,.png" multiple required>
                <small class="text-muted">Máximo 10 arquivos</small>
              </div>
              <div class="col-md-6">
                <input type="email" class="form-control" placeholder="E-mail" name="email" required>
              </div>
              <div class="col-md-6">
                <input type="email" class="form-control" placeholder="E-mail alternativo (opcional)" name="email_alt">
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Telefone" name="telefone" required>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Telefone alternativo (opcional)" name="telefone_alt">
              </div>
              <!-- Endereço PF -->
              <div class="col-12">
                <div class="form-row">
                  <div>
                    <select class="form-select" name="estado" id="estadoPF" required>
                      <option value="">Estado</option>
                    </select>
                  </div>
                  <div>
                    <select class="form-select" name="cidade" id="cidadePF" required>
                      <option value="">Cidade</option>
                    </select>
                  </div>
                  <div>
                    <input type="text" class="form-control" placeholder="CEP" name="cep" id="cepPF" required>
                  </div>
                  <div>
                    <input type="text" class="form-control" placeholder="complemento" name="complemento" required>
                  </div>
                </div>
                <div class="form-row">
                  <div>
                    <input type="text" class="form-control" placeholder="Bairro" name="Bairro" required>
                  </div>
                  <div>
                    <input type="text" class="form-control" placeholder="Rua" name="rua" required>
                  </div>
                  <div>
                    <input type="text" class="form-control" placeholder="Número" name="numero" required>
                  </div>
                  <div>
                    <label class="form-label">Melhor dia de pagamento</label>
                    <select class="form-select" name="melhor_dia_pagamento" required>
                      <option value="">Selecione o dia</option>
                      <script>
                        for(let i=1;i<=31;i++){
                          document.write(`<option value="${String(i).padStart(2,'0')}">${String(i).padStart(2,'0')}</option>`);
                        }
                      </script>
                    </select>
                  </div>
                </div>
              </div>
              <!-- Unidades Consumidoras PF -->
              <div class="uc-section" id="ucPF-section">
                <div class="uc-title">Unidades Consumidoras</div>
                <div id="ucPF-list">
                  <div class="uc-group">
                    <span class="uc-label">Unidade Consumidora 1</span>
                    <div class="uc-fields-row">
                      <div class="form-group">
                        <label>Nº Unidade Consumidora</label>
                        <input type="text" class="form-control" name="unidade_consumidora[]" required>
                      </div>
                      <div class="form-group">
                        <label>Endereço</label>
                        <input type="text" class="form-control" name="endereco_uc[]" required>
                      </div>
                      <div class="form-group">
                        <label>complemento</label>
                        <input type="text" class="form-control" name="complemento_uc[]" required>
                      </div>
                      <div class="form-group">
                        <label>Bairro</label>
                        <input type="text" class="form-control" name="Bairro_uc[]" required>
                      </div>
                      <div class="form-group">
                        <label>Cidade</label>
                        <input type="text" class="form-control" name="Cidade_uc[]" required>
                      </div>
                      <div class="form-group">
                        <label>Número</label>
                        <input type="text" class="form-control" name="numero_uc[]" required>
                      </div>
                      <div class="form-group">
                        <label>Parceiro Indicador</label>
                        <input type="text" class="form-control" name="parceiro_indicador_uc[]" required>
                      </div>
                      <div class="form-group">
                        <label>Nº Contrato Parceiro Indicador</label>
                        <input type="text" class="form-control" name="contrato_parceiro_uc[]" required>
                      </div>
                      <div class="form-group">
                        <label>Nº Contrato Cliente</label>
                        <input type="text" class="form-control" name="contrato_cliente_uc[]" required>
                      </div>
                    </div>
                  </div>
                </div>
                <button type="button" class="btn btn-outline-success btn-sm mt-2" id="addUcPF">Adicionar Unidade Consumidora</button>
              </div>
              <div class="col-12 text-center">
                <button type="submit" class="btn btn-custom">Avançar</button>
              </div>
            </form>
          </div>
          <!-- Pessoa Jurídica -->
          <div class="tab-pane fade" id="pj" role="tabpanel" aria-labelledby="pj-tab">
            <form class="row g-3" id="formPJ" autocomplete="off">
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="CNPJ" name="cnpj" required>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Razão Social" name="razao_social" required>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Nome Fantasia" name="nome_fantasia" required>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Número da Empresa" name="numero_empresa" required>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="CNAI" name="CNAI" required>
              </div>
              <div class="col-md-6">
                <input type="email" class="form-control" placeholder="E-mail da Empresa" name="email_empresa" required>
              </div>
              <div class="col-md-6">
                <input type="email" class="form-control" placeholder="E-mail alternativo (opcional)" name="email_empresa_alt">
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Telefone do Responsável" name="telefone_responsavel" required>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Telefone alternativo (opcional)" name="telefone_responsavel_alt">
              </div>
              <div class="col-md-6">
                <label class="form-label">Melhor dia de pagamento</label>
                <select class="form-select" name="melhor_dia_pagamento_pj" required>
                  <option value="">Selecione o dia</option>
                  <script>
                    for(let i=1;i<=31;i++){
                      document.write(`<option value="${String(i).padStart(2,'0')}">${String(i).padStart(2,'0')}</option>`);
                    }
                  </script>
                </select>
              </div>
              <div class="col-12">
                <h5 class="mt-3">Dados do Responsável</h5>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control" placeholder="Nome do Responsável" name="nome_responsavel" required>
              </div>
              <div class="col-md-3">
                <input type="text" class="form-control" placeholder="CPF do Responsável" name="cpf_responsavel" required>
              </div>
              <div class="col-md-3">
                <input type="text" class="form-control" placeholder="RG do Responsável (opcional)" name="rg_responsavel">
              </div>
              <div class="col-md-6">
                <input type="email" class="form-control" placeholder="E-mail do Responsável" name="email_responsavel" required>
              </div>
              <!-- Endereço PJ -->
              <div class="col-12">
                <div class="form-row">
                  <div>
                    <select class="form-select" name="estado" id="estadoPJ" required>
                      <option value="">Estado</option>
                    </select>
                  </div>
                  <div>
                    <select class="form-select" name="cidade" id="cidadePJ" required>
                      <option value="">Cidade</option>
                    </select>
                  </div>
                  <div>
                    <input type="text" class="form-control" placeholder="CEP" name="cep" id="cepPJ" required>
                  </div>
                  <div>
                    <input type="text" class="form-control" placeholder="complemento" name="complemento" required>
                  </div>
                </div>
                <div class="form-row">
                  <div>
                    <input type="text" class="form-control" placeholder="Bairro" name="Bairro" required>
                  </div>
                  <div>
                    <input type="text" class="form-control" placeholder="Rua" name="rua" required>
                  </div>
                  <div>
                    <input type="text" class="form-control" placeholder="Número" name="numero" required>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <label class="form-label">Anexar documentos de Identificação</label>
                <input type="file" class="form-control" name="doc_anexo_pj[]" accept=".pdf,.jpg,.jpeg,.png" multiple required>
                <small class="text-muted">Máximo 10 arquivos</small>
              </div>
              <div class="col-md-6">
                <label class="form-label">CARTÃO CNPJ QSA OU CONTRATO SOCIAL</label>
                <input type="file" class="form-control" name="conta_luz_pj[]" accept=".pdf,.jpg,.jpeg,.png" multiple required>
                <small class="text-muted">Máximo 10 arquivos</small>
              </div> 
               <div class="col-md-6">
                <label class="form-label">Anexar conta de luz</label>
                <input type="file" class="form-control" name="conta_luz_pj[]" accept=".pdf,.jpg,.jpeg,.png" multiple required>
                <small class="text-muted">Máximo 10 arquivos</small>
              </div>
              <div class="col-md-6">
                <label class="form-label"> DOCUMENTO DE IDENTIFICAÇÃO DO SOCIO ADMINISTRADOR</label>
                <input type="file" class="form-control" name="conta_luz_pj[]" accept=".pdf,.jpg,.jpeg,.png" multiple required>
                <small class="text-muted">Máximo 10 arquivos</small>
              </div>
              <!-- Unidades Consumidoras PJ -->
              <div class="uc-section" id="ucPJ-section">
                <div class="uc-title">Unidades Consumidoras</div>
                <div id="ucPJ-list">
                  <div class="uc-group">
                    <span class="uc-label">Unidade Consumidora 1</span>
                    <div class="uc-fields-row">
                      <div class="form-group">
                        <label>Nº Unidade Consumidora</label>
                        <input type="text" class="form-control" name="unidade_consumidora[]" required>
                      </div>
                      <div class="form-group">
                        <label>Endereço</label>
                        <input type="text" class="form-control" name="endereco_ucpj[]" required>
                      </div>
                      <div class="form-group">
                        <label>complemento</label>
                        <input type="text" class="form-control" name="complemento_ucpj[]" required>
                      </div>
                      <div class="form-group">
                        <label>Bairro</label>
                        <input type="text" class="form-control" name="Bairro_ucpj[]" required>
                      </div>
                      <div class="form-group">
                        <label>Cidade</label>
                        <input type="text" class="form-control" name="Cidade_ucpj[]" required>
                      </div>
                      <div class="form-group">
                        <label>Número</label>
                        <input type="text" class="form-control" name="numero_ucpj[]" required>
                      </div>
                      <div class="form-group">
                        <label>Parceiro Indicador</label>
                        <input type="text" class="form-control" name="parceiro_indicador_ucpj[]" required>
                      </div>
                      <div class="form-group">
                        <label>Nº Contrato Parceiro Indicador</label>
                        <input type="text" class="form-control" name="contrato_parceiro_ucpj[]" required>
                      </div>
                      <div class="form-group">
                        <label>Nº Contrato Cliente</label>
                        <input type="text" class="form-control" name="contrato_cliente_ucpj[]" required>
                      </div>
                    </div>
                  </div>
                </div>
                <button type="button" class="btn btn-outline-success btn-sm mt-2" id="addUcPJ">Adicionar Unidade Consumidora</button>
              </div>
              <div class="col-12 text-center">
                <button type="submit" class="btn btn-custom">Avançar</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
      <script>
        // Estados e cidades do Brasil (exemplo simplificado)
        let estadosCidades = {};

        function carregarEstadosCidades() {
          fetch('https://servicodados.ibge.gov.br/api/v1/localidades/estados?orderBy=nome')
            .then(resp => resp.json())
            .then(estados => {
              const promises = estados.map(estado =>
                fetch(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${estado.id}/municipios`)
                  .then(resp => resp.json())
                  .then(municipios => {
                    estadosCidades[estado.sigla] = municipios.map(m => m.nome);
                  })
              );
              Promise.all(promises).then(() => {
                popularEstados('estadoPF');
                popularEstados('estadoPJ');
              });
            });
        }
        carregarEstadosCidades();

        function popularEstados(selectId) {
          const select = document.getElementById(selectId);
          select.innerHTML = '<option value="">Estado</option>';
          Object.keys(estadosCidades).forEach(uf => {
            const opt = document.createElement('option');
            opt.value = uf;
            opt.textContent = uf;
            select.appendChild(opt);
          });
        }

        function popularCidades(estadoSelectId, cidadeSelectId) {
          const estado = document.getElementById(estadoSelectId).value;
          const cidadeSelect = document.getElementById(cidadeSelectId);
          cidadeSelect.innerHTML = '<option value="">Cidade</option>';
          if (estadosCidades[estado]) {
            estadosCidades[estado].forEach(cidade => {
              const opt = document.createElement('option');
              opt.value = cidade;
              opt.textContent = cidade;
              cidadeSelect.appendChild(opt);
            });
          }
        }

        // Unidade Consumidora dinâmica PF e PJ com campos completos
        document.addEventListener('DOMContentLoaded', function () {
          // Pessoa Física
          popularEstados('estadoPF');
          document.getElementById('estadoPF').addEventListener('change', function () {
            popularCidades('estadoPF', 'cidadePF');
          });
          // Pessoa Jurídica
          popularEstados('estadoPJ');
          document.getElementById('estadoPJ').addEventListener('change', function () {
            popularCidades('estadoPJ', 'cidadePJ');
          });

          // Adicionar/remover Unidade Consumidora PF
          const ucPFList = document.getElementById('ucPF-list');
          document.getElementById('addUcPF').addEventListener('click', function () {
            const count = ucPFList.querySelectorAll('.uc-group').length;
            if (count < 20) {
              const div = document.createElement('div');
              div.className = 'uc-group';
              div.innerHTML = `
                <span class="uc-label">Unidade Consumidora ${count + 1}</span>
                <button type="button" class="uc-remove-btn" title="Remover unidade">&times;</button>
                <div class="uc-fields-row">
                  <div class="form-group">
                    <label>Nº Unidade Consumidora</label>
                    <input type="text" class="form-control" name="unidade_consumidora[]" required>
                  </div>
                  <div class="form-group">
                    <label>Endereço</label>
                    <input type="text" class="form-control" name="endereco_uc[]" required>
                  </div>
                  <div class="form-group">
                    <label>complemento</label>
                    <input type="text" class="form-control" name="complemento_uc[]" required>
                  </div>
                  <div class="form-group">
                    <label>Bairro</label>
                    <input type="text" class="form-control" name="Bairro_uc[]" required>
                  </div>
                  <div class="form-group">
                    <label>Cidade</label>
                    <input type="text" class="form-control" name="Cidade_uc[]" required>
                  </div>
                  <div class="form-group">
                    <label>Número</label>
                    <input type="text" class="form-control" name="numero_uc[]" required>
                  </div>
                  <div class="form-group">
                    <label>Parceiro Indicador</label>
                    <input type="text" class="form-control" name="parceiro_indicador_uc[]" required>
                  </div>
                  <div class="form-group">
                    <label>Nº Contrato Parceiro Indicador</label>
                    <input type="text" class="form-control" name="contrato_parceiro_uc[]" required>
                  </div>
                  <div class="form-group">
                    <label>Nº Contrato Cliente</label>
                    <input type="text" class="form-control" name="contrato_cliente_uc[]" required>
                  </div>
                </div>
              `;
              div.querySelector('.uc-remove-btn').onclick = function () {
                div.remove();
                ucPFList.querySelectorAll('.uc-group').forEach((el, idx) => {
                  el.querySelector('.uc-label').textContent = `Unidade Consumidora ${idx + 1}`;
                });
              };
              ucPFList.appendChild(div);
            } else {
              alert('Máximo de 20 unidades consumidoras por pessoa.');
            }
          });

          // Adicionar/remover Unidade Consumidora PJ
          const ucPJList = document.getElementById('ucPJ-list');
          document.getElementById('addUcPJ').addEventListener('click', function () {
            const count = ucPJList.querySelectorAll('.uc-group').length;
            if (count < 20) {
              const div = document.createElement('div');
              div.className = 'uc-group';
              div.innerHTML = `
                <span class="uc-label">Unidade Consumidora ${count + 1}</span>
                <button type="button" class="uc-remove-btn" title="Remover unidade">&times;</button>
                <div class="uc-fields-row">
                  <div class="form-group">
                    <label>Nº Unidade Consumidora</label>
                    <input type="text" class="form-control" name="unidade_consumidora[]" required>
                  </div>
                  <div class="form-group">
                    <label>Endereço</label>
                    <input type="text" class="form-control" name="endereco_ucpj[]" required>
                  </div>
                  <div class="form-group">
                    <label>complemento</label>
                    <input type="text" class="form-control" name="complemento_ucpj[]" required>
                  </div>
                  <div class="form-group">
                    <label>Bairro</label>
                    <input type="text" class="form-control" name="Bairro_ucpj[]" required>
                  </div>
                  <div class="form-group">
                    <label>Cidade</label>
                    <input type="text" class="form-control" name="Cidade_ucpj[]" required>
                  </div>
                  <div class="form-group">
                    <label>Número</label>
                    <input type="text" class="form-control" name="numero_ucpj[]" required>
                  </div>
                  <div class="form-group">
                    <label>Parceiro Indicador</label>
                    <input type="text" class="form-control" name="parceiro_indicador_ucpj[]" required>
                  </div>
                  <div class="form-group">
                    <label>Nº Contrato Parceiro Indicador</label>
                    <input type="text" class="form-control" name="contrato_parceiro_ucpj[]" required>
                  </div>
                  <div class="form-group">
                    <label>Nº Contrato Cliente</label>
                    <input type="text" class="form-control" name="contrato_cliente_ucpj[]" required>
                  </div>
                </div>
              `;
              div.querySelector('.uc-remove-btn').onclick = function () {
                div.remove();
                ucPJList.querySelectorAll('.uc-group').forEach((el, idx) => {
                  el.querySelector('.uc-label').textContent = `Unidade Consumidora ${idx + 1}`;
                });
              };
              ucPJList.appendChild(div);
            } else {
              alert('Máximo de 20 unidades consumidoras por pessoa.');
            }
          });

          // Limitar arquivos anexados a 10
          function limitarArquivos(input) {
            input.addEventListener('change', function () {
              if (this.files.length > 10) {
                alert('Selecione no máximo 10 arquivos.');
                this.value = '';
              }
            });
          }
          limitarArquivos(document.querySelector('input[name="doc_anexo[]"]'));
          limitarArquivos(document.querySelector('input[name="conta_luz[]"]'));
          limitarArquivos(document.querySelector('input[name="doc_anexo_pj[]"]'));
          limitarArquivos(document.querySelector('input[name="conta_luz_pj[]"]'));

          // CEP auto-preenchimento (ViaCEP)
          function buscarCEP(cep, prefix) {
            cep = cep.replace(/\D/g, '');
            if (cep.length !== 8) return;
            fetch(`https://viacep.com.br/ws/${cep}/json/`)
              .then(resp => resp.json())
              .then(data => {
                if (!data.erro) {
                  document.querySelector(`#${prefix} input[name="rua"]`).value = data.logradouro || '';
                  document.querySelector(`#${prefix} select[name="estado"]`).value = data.uf || '';
                  popularCidades(`${prefix}estado`, `${prefix}cidade`);
                  const cidadeSelect = document.querySelector(`#${prefix} select[name="cidade"]`);
                  let tentativas = 0;
                  function tentarSelecionarCidade() {
                    tentativas++;
                    if ([...cidadeSelect.options].some(opt => opt.value === data.localidade)) {
                      cidadeSelect.value = data.localidade || '';
                    } else if (tentativas < 10) {
                      setTimeout(tentarSelecionarCidade, 100);
                    }
                  }
                  tentarSelecionarCidade();
                }
              });
          }
          document.getElementById('cepPF').addEventListener('blur', function () {
            buscarCEP(this.value, 'pf');
          });
          document.getElementById('cepPJ').addEventListener('blur', function () {
            buscarCEP(this.value, 'pj');
          });

          // Validação de campos obrigatórios
          function validarForm(form) {
            let valid = true;
            form.querySelectorAll('[required]').forEach(input => {
              if (!input.value) valid = false;
            });
            // Email ou email alternativo, telefone ou telefone alternativo (PF)
            if (form.id === 'formPF') {
              const email = form.querySelector('input[name="email"]').value;
              const emailAlt = form.querySelector('input[name="email_alt"]').value;
              const tel = form.querySelector('input[name="telefone"]').value;
              const telAlt = form.querySelector('input[name="telefone_alt"]').value;
              if (!email && !emailAlt) valid = false;
              if (!tel && !telAlt) valid = false;
            }
            return valid;
          }
          document.getElementById('formPF').addEventListener('submit', function (e) {
            if (!validarForm(this)) {
              e.preventDefault();
              alert('Preencha todos os campos obrigatórios.');
            }
          });
          document.getElementById('formPJ').addEventListener('submit', function (e) {
            if (!validarForm(this)) {
              e.preventDefault();
              alert('Preencha todos os campos obrigatórios.');
            }
          });
        });
      </script>
    </section>
  </main>
  <footer>
    <div class="container">
      <p class="mb-1">&copy; 2025 Ecossistema Energia limpa . Todos os direitos reservados.</p>
      <p class="small">Página desenvolvida por Gabriela Alves Rodrigues.</p>
    </div>
  </footer>
 
<script>
  document.getElementById('form-cadastro-user').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const usuario = document.getElementById('usuario').value.trim();
    const senha = document.getElementById('senha').value.trim();
    const permissoesRaw = document.getElementById('permissoes').value.trim();
    const permissoes = permissoesRaw.split(',').map(p => p.trim());

    try {
      const resposta = await fetch('/registrar-usuario', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ usuario, senha, permissoes })
      });

      const dados = await resposta.json();
      const msg = document.getElementById('mensagem-cadastro');
      msg.textContent = dados.mensagem;

      if (resposta.ok) {
        msg.style.color = 'green';
        e.target.reset();
      } else {
        msg.style.color = 'red';
      }
    } catch (err) {
      console.error(err);
      document.getElementById('mensagem-cadastro').textContent = 'Erro ao conectar com o servidor';
       alert('✅ Indicador cadastrado com sucesso!');
      window.location.href = 'userdados.html';
    }
  });
</script>


</body>
</html>s